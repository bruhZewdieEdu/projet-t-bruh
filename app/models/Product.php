<?php require_once __DIR__.'/../core/Model.php'; class Product extends Model{
public function allActive():array{ return $this->db->query("SELECT p.*,b.name AS brand_name FROM products p JOIN brands b ON b.id=p.brand_id WHERE p.is_active=1 ORDER BY p.created_at DESC")->fetchAll(); }
public function find(int $id){ $s=$this->db->prepare("SELECT p.*,b.name AS brand_name FROM products p JOIN brands b ON b.id=p.brand_id WHERE p.id=?"); $s->execute([$id]); return $s->fetch(); }
public function create(array $d):bool{ $sql="INSERT INTO products (brand_id,name,`condition`,format,price_chf,stock_qty,is_active,description) VALUES (:brand_id,:name,:condition,:format,:price_chf,:stock_qty,:is_active,:description)"; return $this->db->prepare($sql)->execute($d); }
public function update(int $id,array $d):bool{ $d['id']=$id; $sql="UPDATE products SET brand_id=:brand_id,name=:name,`condition`=:condition,format=:format,price_chf=:price_chf,stock_qty=:stock_qty,is_active=:is_active,description=:description WHERE id=:id"; return $this->db->prepare($sql)->execute($d); }
public function softDelete(int $id):bool{ return $this->db->prepare("UPDATE products SET is_active=0 WHERE id=?")->execute([$id]); }}