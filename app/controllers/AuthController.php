<?php require_once __DIR__.'/../models/User.php'; class AuthController extends Controller{
public function login(){ $error=null; if($this->isPost()){ $email=trim($_POST['email']??''); $pass=$_POST['password']??'';
$u=(new User())->findByEmail($email); if($u&&password_verify($pass,$u['password_hash'])){ $_SESSION['user']=['id'=>$u['id'],'email'=>$u['email'],'role'=>$u['role']]; $this->redirect(url('admin','index')); } else $error='Identifiants invalides'; }
$this->render('login',['title'=>'Connexion','error'=>$error]); } public function logout(){ unset($_SESSION['user']); $this->redirect(url('home','index')); }}